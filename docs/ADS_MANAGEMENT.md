# Система управления рекламой

## Обзор

Система управления рекламой позволяет администраторам создавать, редактировать и удалять рекламные блоки, которые отображаются на главной странице сайта.

## Функциональность

### Основные возможности:

- ✅ Создание новых рекламных блоков
- ✅ Редактирование существующих реклам
- ✅ Удаление рекламы
- ✅ Установка срока действия (автоматическое истечение)
- ✅ Активация/деактивация рекламы
- ✅ Автоматическая ротация рекламы
- ✅ Очистка истекших реклам

### Структура рекламного блока:

- **Заголовок** - основной заголовок рекламы
- **Содержание** - описание рекламы
- **URL изображения** - ссылка на изображение (опционально)
- **Ссылка** - URL для перехода (опционально)
- **Дата истечения** - когда реклама должна стать неактивной (опционально)
- **Статус активности** - включена/выключена

## Доступ к системе

### Админ-панель:

1. Перейдите на `/admin/ads`
2. Войдите как администратор
3. Используйте интерфейс для управления рекламой

### API Endpoints:

#### Получение активной рекламы:

```
GET /api/ads/active
```

#### Ротация рекламы:

```
GET /api/ads/rotate
```

#### Управление рекламой (только для админов):

```
GET /api/admin/ads          - получить все рекламы
POST /api/admin/ads         - создать новую рекламу
PUT /api/admin/ads/[id]     - обновить рекламу
DELETE /api/admin/ads/[id]  - удалить рекламу
POST /api/admin/ads/cleanup - деактивировать истекшие
```

## Автоматизация

### Автоматическая ротация:

Реклама автоматически ротируется каждые 24 часа. Можно настроить cron job:

```bash
# Каждый день в полночь
0 0 * * * cd /path/to/project && node scripts/rotate-ads.js
```

### Автоматическое истечение:

- Рекламы с установленной датой истечения автоматически деактивируются
- Можно запустить очистку вручную через админ-панель

## Примеры использования

### Создание рекламы на неделю:

1. Заголовок: "Скидка 20% на все товары!"
2. Содержание: "Только до конца недели скидка на весь ассортимент"
3. URL изображения: "https://example.com/banner.jpg"
4. Ссылка: "https://shop.example.com"
5. Дата истечения: через 7 дней от текущей даты

### Создание постоянной рекламы:

1. Заголовок: "Реклама вашего бизнеса"
2. Содержание: "Разместите рекламу здесь"
3. Дата истечения: оставить пустой
4. Статус: активна

## Технические детали

### База данных:

Модель `Advertisement` содержит:

- `id` - уникальный идентификатор
- `title` - заголовок
- `content` - содержание
- `imageUrl` - URL изображения (опционально)
- `linkUrl` - ссылка для перехода (опционально)
- `expiresAt` - дата истечения (опционально)
- `isActive` - статус активности
- `createdAt` - дата создания
- `updatedAt` - дата обновления

### Отображение на сайте:

- Блок рекламы отображается в левом верхнем углу главной страницы
- Показывается только активная реклама, которая не истекла
- Если нет активной рекламы, блок скрывается
- Поддерживает изображения и кликабельные ссылки

## Безопасность

- Доступ к управлению рекламой только для пользователей с ролью `ADMIN`
- Все API endpoints защищены авторизацией
- Валидация входных данных
- Защита от XSS через санитизацию контента

## Мониторинг

### Логи:

- Все операции с рекламой логируются
- Ошибки записываются в консоль сервера
- Статистика показов и кликов (планируется)

### Уведомления:

- Уведомления об истечении рекламы (планируется)
- Email уведомления администраторам (планируется)
