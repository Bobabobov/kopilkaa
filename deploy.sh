#!/bin/bash

# ะกะบัะธะฟั ะดะปั ะดะตะฟะปะพั ะฟัะธะปะพะถะตะฝะธั ะฝะฐ ัะตัะฒะตัะต
set -e  # ะััะฐะฝะพะฒะธัั ะฒัะฟะพะปะฝะตะฝะธะต ะฟัะธ ะพัะธะฑะบะต

echo "๐ ะะฐัะธะฝะฐะตะผ ะดะตะฟะปะพะน..."

# ะะตัะตัะพะดะธะผ ะฒ ะดะธัะตะบัะพัะธั ะฟัะพะตะบัะฐ
cd /opt/kopilkaa

echo "๐ฅ ะะฑะฝะพะฒะปัะตะผ ะบะพะด ะธะท ัะตะฟะพะทะธัะพัะธั..."
git pull

echo "๐๏ธ  ะัะธะผะตะฝัะตะผ ะผะธะณัะฐัะธะธ ะฑะฐะทั ะดะฐะฝะฝัั..."
npx prisma migrate deploy

echo "๐จ ะกะพะฑะธัะฐะตะผ ะฟัะพะตะบั..."
npm run build

echo "๐ ะะตัะตะทะฐะฟััะบะฐะตะผ ะฟัะธะปะพะถะตะฝะธะต..."
pm2 restart kopilka

echo "โ ะะตะฟะปะพะน ะทะฐะฒะตััะตะฝ!"
echo "๐ ะกัะฐััั ะฟัะธะปะพะถะตะฝะธั:"
pm2 status kopilka

