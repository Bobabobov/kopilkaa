# Обработка ошибок в коде

Краткие рекомендации, чтобы подход к ошибкам был предсказуемым.

## API routes (app/api/)

- **Ошибки сервера:** оборачивать логику в `try/catch`, при падении возвращать `NextResponse.json({ error: "…" }, { status: 500 })`.
- **Валидация:** при неверных входных данных — `400` и понятное сообщение.
- **Логирование:** в `catch` логировать `console.error` (в проде уходит в PM2, см. `docs/LOGS.md`). Не логировать чувствительные данные (пароли, токены).
- **Типы ответов:** по возможности возвращать один формат ошибки, например `{ error: string }` или `{ message: string }`.

## Клиент (компоненты, хуки)

- **Запросы к API:** обрабатывать `response.ok === false`, показывать пользователю сообщение (toast, inline) и при необходимости логировать в консоль.
- **Формы:** валидация на клиенте + показ ошибок с сервера в полях или общим блоком.
- **Критические сбои:** при желании можно добавить React Error Boundary на уровне layout или страницы, чтобы падение одного дерева не ломало весь экран; пока в проекте error boundaries нет — при появлении добавить сюда ссылку на компонент.

## Где не дублировать

- Детали логов и просмотр в проде — в `docs/LOGS.md`.
- Архитектура слоёв — в `docs/ARCHITECTURE.md`.
